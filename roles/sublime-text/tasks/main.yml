---

# https://launchpad.net/~webupd8team/+archive/ubuntu/sublime-text-3

-   apt_key:
        id: 7B2C3B0889BF5709A105D03AC2518248EEA14886
        keyserver: pool.sks-keyservers.net

# FIXME: use apt_repository when it supports multiple lines and filename
-   copy:
        dest: /etc/apt/sources.list.d/sublime-text.list
        content: |
            # This file is managed by Ansible. DO NOT EDIT.
            deb http://ppa.launchpad.net/webupd8team/sublime-text-3/ubuntu {{ ppa_ubuntu_codename }} main
            deb-src http://ppa.launchpad.net/webupd8team/sublime-text-3/ubuntu {{ ppa_ubuntu_codename }} main

    register: apt_repository

-   apt:
        update_cache: yes
    when: apt_repository.get('src') != None

-   apt:
        name: sublime-text-installer
        state: absent
