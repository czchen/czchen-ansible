---

-   file:
        dest: '{{ item.dest }}'
        owner: root
        group: root
        mode: '{{ item.mode | default("0755") }}'
        state: directory

    with_items:
        -   dest: /etc/sudoers.d
        -   dest: /etc/sysctl.d
        -   dest: /etc/udev/rules.d
        -   dest: /etc/apt/sources.list.d
        -   dest: /etc/modprobe.d

-   copy:
        dest: '{{ item.dest }}'
        owner: root
        group: root
        mode: '{{ item.mode | default("0644") }}'
        content: '{{ item.content }}'

    with_items:
    -   dest: /etc/sudoers.d/czchen
        mode: '0400'
        content: |
            # This file is managed by Ansible. DO NOT EDIT.

            Defaults umask = 0022
            Defaults umask_override

    -   dest: /etc/sysctl.d/czchen.conf
        content: |
            # This file is managed by Ansible. DO NOT EDIT.

            kernel.sysrq = 1

    -   dest: /etc/udev/rules.d/99-czchen.rules
        content: |
            # This file is managed by Ansible. DO NOT EDIT.

            SUBSYSTEM=="usb", ATTR{idVendor}=="18d1", TAG+="uaccess"

    -   dest: /etc/modprobe.d/99-czchen.conf
        content: |
            # This file is managed by Ansible. DO NOT EDIT.

            options iwlwifi power_save=n
            options iwldvm power_scheme=1

            options iwlwifi 11n_disable=1

    -   dest: /etc/udev/hwdb.d/99-czchen.hwdb
        content: |
            # This file is managed by Ansible. DO NOT EDIT.

            # https://forums.puri.sm/t/keyboard-layout-unable-to-recognize-pipe/2022/10
            evdev:atkbd:dmi:bvn*:bvr*:bd*:svnPurism:pnLibrem13v2*
             KEYBOARD_KEY_56=backslash

-   lineinfile:
        name: /var/lib/dpkg/arch
        line: 'i386'

# FIXME: use apt_repository when it supports multiple lines and filename

-   apt:
        name: '{{ item.name }}'
        state: '{{ item.state | default("present") }}'
        purge: yes

    with_items:
        -   name: afl
        -   name: apt-file
        -   name: apt-listchanges
        -   name: asciinema
        -   name: atom
        -   name: autoconf
        -   name: automake
        -   name: autopkgtest
        -   name: ben
        -   name: blktrace
        -   name: bmon
        -   name: build-essential
        -   name: cabal-install
        -   name: check-all-the-things
        -   name: cloc
        -   name: cmake
        -   name: cme
        -   name: cryfs
        -   name: cscope
        -   name: debdelta
        -   name: debhelper
        -   name: debian-archive-keyring
        -   name: debian-goodies
        -   name: debian-keyring
        -   name: debian-policy
        -   name: debmake
        -   name: deborphan
        -   name: devscripts
        -   name: dh-autoreconf
        -   name: dh-make
        -   name: dnsutils
        -   name: dput-ng
        -   name: dropbox
        -   name: dstat
        -   name: exuberant-ctags
        -   name: fcitx-chewing
        -   name: font-manager
        -   name: fonts-noto
        -   name: fonts-noto-cjk
        -   name: ghc
        -   name: git
        -   name: git-buildpackage
        -   name: git-crypt
        -   name: git-dpm
        -   name: git-lfs
        -   name: gitlab-ci-multi-runner
        -   name: glances
        -   name: glibc-doc
        -   name: glibc-doc-reference
        -   name: gnupg2
        -   name: go-dep
        -   name: goobook
        -   name: gufw
        -   name: how-can-i-help
        -   name: insomnia
        -   name: jq
        -   name: keybase
        -   name: ledger
        -   name: libghc-hspec-dev
        -   name: libtool
        -   name: lsb-release
        -   name: lshw
        -   name: lxc
        -   name: manpages
        -   name: manpages-dev
        -   name: manpages-posix
        -   name: manpages-posix-dev
        -   name: msmtp
        -   name: mutt
        -   name: needrestart
        -   name: net-tools
        -   name: network-manager-openvpn-gnome
        -   name: network-manager-pptp # for VPN
        -   name: nmap
        -   name: ntp
        -   name: p7zip-full
        -   name: parcimonie
        -   name: pass
        -   name: pinfo
        -   name: playonlinux
        -   name: pylama
        -   name: python3-venv
        -   name: quilt
        -   name: ratt
        -   name: reptyr
        -   name: rr
        -   name: sbuild
        -   name: scdaemon
        -   name: shellcheck
        -   name: shutter
        -   name: signing-party
        -   name: silversearcher-ag
        -   name: sirikali
        -   name: snapd
        -   name: sudo
        -   name: sysdig
        -   name: sysstat
        -   name: system-config-lvm
        -   name: texinfo
        -   name: tig
        -   name: tiptop
        -   name: tmux
        -   name: tree
        -   name: ubuntu-archive-keyring
        -   name: ubuntu-dev-tools
        -   name: ubuntu-make
        -   name: unattended-upgrades
        -   name: valgrind
        -   name: vim-gtk # For system clipboard
        -   name: virt-manager
        -   name: voltron
        -   name: yadm
        -   name: yamllint
        -   name: yapf
        -   name: yarn
        -   name: zplug
        -   name: zsh
