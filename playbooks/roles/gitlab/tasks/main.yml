---

# https://gitlab.com/gitlab-org/gitlab-ci-multi-runner/blob/master/docs/install/linux-repository.md

-   apt_key:
        url: https://packages.gitlab.com/runner/gitlab-ci-multi-runner/gpgkey

-   copy:
        dest: /etc/apt/sources.list.d/gitlab.list
        content: |
            # This file is managed by Ansible. DO NOT EDIT.

            deb https://packages.gitlab.com/runner/gitlab-ci-multi-runner/debian/ {{ gitlab_debian_codename }} main
            deb-src https://packages.gitlab.com/runner/gitlab-ci-multi-runner/debian/ {{ gitlab_debian_codename }} main

    register: apt_repository

-   apt:
        update_cache: yes
    when: apt_repository.get('src') != None

-   apt:
        name: '{{ item.name }}'

    with_items:
        -   name: apt-transport-https
